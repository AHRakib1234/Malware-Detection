import json



def extract_api_calls(report_path):
	api_calls = []

	with open(report_path, 'r') as f:
		report = json.load(f)

	for f in report['signatures']:
		if 'marks' in f:
			for mark in f['marks']:
				if 'call' in mark:
					api_calls.append(mark['call']['api'])
					
	# if 'behavior' in report and 'processes' in report['behavior']:
	# 	for process in report['behavior']['processes']:
	# 		if 'calls' in process:
	# 			for call in process['calls']:
	# 				if 'api' in call:
	# 					api_calls.append(call['api'])


	return api_calls

# Example usage:
report_path = 'path'
api_calls = extract_api_calls(report_path)
print("API Calls:")
print(len(api_calls))
#for call in api_calls:
#    print(call)

